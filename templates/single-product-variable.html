{% extends 'base.html' %}

{% load static %}
{% block title %}Product - Roren{% endblock %}
{% block content %}

        <!-- Begin Roren's Breadcrumb Area -->
        <div class="breadcrumb-area">
            <div class="container">
                <div class="breadcrumb-content">
                    <h2>{{ prod.name }}</h2>
                    <ul>
                        <li><a href="{% url 'index' %}">Home</a></li>
                        <li class="active">Single Product </li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- Roren's Breadcrumb Area End Here -->
        
        <!-- Begin Roren's Single Product Variable Area -->
        
        <div class="sp-area">
            <div class="container-fluid">
                <div class="sp-nav">
                    <div class="row">
                        <div class="col-lg-4">
                            <div class="sp-img_area">
                                <div class="sp-img_slider slick-img-slider uren-slick-slider" data-slick-options='{
                                "slidesToShow": 1,
                                "arrows": false,
                                "fade": true,
                                "draggable": false,
                                "swipe": true,
                                "asNavFor": ".sp-img_slider-nav"
                                }'>
                                    <div class="single-slide red zoom">
                                        <img src="{{ prod.img.url }}" alt="Roren's Product Image">
                                    </div>
                                </div>
                                <div class="sp-img_slider-nav slick-slider-nav uren-slick-slider slider-navigation_style-3" data-slick-options='{
                                    "slidesToShow": 3,
                                    "asNavFor": ".sp-img_slider",
                                    "focusOnSelect": true,
                                    "arrows" : true,
                                    "spaceBetween": 30
                                }' data-slick-responsive='[
                                        {"breakpoint":1501, "settings": {"slidesToShow": 3}},
                                        {"breakpoint":992, "settings": {"slidesToShow": 4}},
                                        {"breakpoint":768, "settings": {"slidesToShow": 3}},
                                        {"breakpoint":575, "settings": {"slidesToShow": 2}}
                                    ]'>
                                    <div class="single-slide red">
                                        <img src="{{ prod.img.url }}" alt="Roren's Product Thumnail">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-8">
                            <div class="sp-content">
                                <div class="sp-heading">
                                    <h5><a href="#">{{ prod.name }}</a></h5>
                                </div>
                                <span class="reference">Reference: {{ prod.id }}</span>
                                <div class="sp-essential_stuff">
                                    <ul>
                                        <li>Brand: <a href="javascript:void(0)">{{ prod.brand.name }}</a></li>
                                        <li>Availability: <a href="javascript:void(0)">In Stock</a></li>
                                
                                        {% if prod.offer %}
                                        <li>
                                            <div class="price-box">
                                                <span class="new-price">Ksh. <strike>{{prod.price}}</strike>  &nbsp; Ksh.{{prod.sale_price}}</span>
                                            </div>
                                        </li>
                                        {% else %}
                                        <li>Price: <a href="javascript:void(0)">{{ prod.price }}</a></li> 
                                        {% endif %}
                                    </ul>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-2" style="display: flex; align-items: center;">Quantity:</div>
                                    <div class="col-md-2" style="display: flex; align-items: center;">
                                        <select class="form-select" id="qty-cart" style="margin-left: -95px; width: 50px;">
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="qty-btn_area">
                                    <ul>
                                        <li>
                                            <form method="post" action="{% url 'cart:cart_summary' %}" class="add-to-cart-form">
                                                {% csrf_token %}
                                                <input type="hidden" name="product_id" value="{{ prod.id }}">
                                                <button type="submit" class="qty-cart_btn"  title="Add To Cart" id="add-cart">
                                                    Add to Cart
                                                </button>
                                            </form>
                                        </li>
                                    </ul>
                                </div>
                                <div class="uren-tag-line">
                                    <h6>Tags:</h6>
                                    <a href="javascript:void(0)">{{ prod.category.name }}</a>
                                </div>
                                <div class="uren-social_link">
                                    <ul>
                                        <li class="facebook">
                                            <a href="https://www.facebook.com/profile.php?id=100092657760285&mibextid=ZbWKwL" data-toggle="tooltip" target="_blank" title="Facebook">
                                                <i class="fab fa-facebook"></i>
                                            </a>
                                        </li>
                                        <li class="twitter">
                                            <a href="https://twitter.com/Rorenauto?t=2jm8rpW9FsiM0bE8RLHQ5w&s=08" data-toggle="tooltip" target="_blank" title="Twitter">
                                                <i class="fab fa-twitter-square"></i>
                                            </a>
                                        </li>
                                        <li class="instagram">
                                            <a href="https://www.instagram.com/rorenautomotors?igshid=MzNlNGNkZWQ4Mg%3D%3D" data-toggle="tooltip" target="_blank" title="Instagram">
                                                <i class="fab fa-instagram"></i>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Roren's Single Product Variable Area End Here -->

        <!-- Begin Roren's Single Product Tab Area -->
        <div class="sp-product-tab_area">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="sp-product-tab_nav">
                            <div class="product-tab">
                                <ul class="nav product-menu">
                                    <li><a class="" data-toggle="tab" href="#description"><span>{{ prod.desc }}</span></a>
                                    </li>
                                    <li><a data-toggle="tab" href="#specification"><span>{{ prod.specification }}</span></a></li>
                                </ul>
                            </div>
                            <div class="tab-content uren-tab_content">
                                <div id="description" class="tab-pane active show" role="tabpanel">
                                    <div class="product-description">
                                        <ul>
                                            <li>
                                                <strong>{{ prod.name }}</strong>
                                                <span>{{ prod.desc }}</span>
                                            </li>
                                            

                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Roren's Single Product Tab Area End Here -->

        <!-- Begin Roren's Brand Area -->
        <div class="uren-brand_area">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="section-title_area">
                            <span>Top Quality Partner</span>
                            <h3>Shop By Brands</h3>
                        </div>
                        <div class="product-slider uren-slick-slider slider-navigation_style-1 img-hover-effect_area" data-slick-options='{
                            "slidesToShow": 6,
                            "arrows" : true
                            }' data-slick-responsive='[
                                                    {"breakpoint":1501, "settings": {"slidesToShow": 4}},
                                                    {"breakpoint":1200, "settings": {"slidesToShow": 3}},
                                                    {"breakpoint":992, "settings": {"slidesToShow": 2}},
                                                    {"breakpoint":767, "settings": {"slidesToShow": 1}},
                                                    {"breakpoint":480, "settings": {"slidesToShow": 1}}
                                                ]'>
                            {% for bra in brands %}
                            <div class="slide-item">
                                <div class="inner-slide">
                                    <div class="slide-image_area">
                                        <a href="{% url 'brandpage' brand_id=bra.id %}">
                                            <img src="{{bra.img.url}}" alt="{{ bra.name }} Image">
                                        </a>
                                    </div>
                                    <div class="slide-content_area">
                                        <h3><a href="{% url 'brandpage' brand_id=bra.id %}">{{ bra.name }}</a></h3>
                                        <span>({{ bra.product_count }} Products)</span>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Roren's Brand Area End Here -->


        <script>
            var cartAddUrl = "{% url 'cart:cart_add' %}";
            console.log("Cart Add URL:", cartAddUrl);
        </script>
        
        <script>
            $(document).on('click', '#add-cart', function(e){
                e.preventDefault();
                $.ajax({
                    type: 'POST',
                    url: cartAddUrl,
                    data: {
                        product_id: $('input[name="product_id"]').val(),
                        product_qty: $('#qty-cart option:selected').text(),
                        csrfmiddlewaretoken: '{{ csrf_token }}',
                        action: 'post'
                    },
        
                    success: function(json){
                        //console.log(json);
                        document.getElementById("cart_quantity"). 
                            textContent = json.qty
                        location.reload()
                    },
        
                    error: function(xhr, errmsg, err){
        
                    }
                });
            });
        </script>
        
        
{% endblock %}